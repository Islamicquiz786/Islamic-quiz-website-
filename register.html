<!doctype html>
<html lang="en">    
<head>    
  <meta charset="UTF-8">    
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">    
  <title>Islamic Quiz Earning Platform - Register</title>    
  <link rel="preconnect" href="https://fonts.googleapis.com">  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>  
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">  
  <style>    
    /* All previous styles remain the same */
    
    .loading {
      display: none;
      color: #00ffe5;
      text-align: center;
      margin: 15px 0;
      text-shadow: 0 0 5px #00ffe5;
      font-size: 14px;
    }
  </style>    
</head>    
<body>    
  <div class="overlay"></div>    
  <div class="register-box">    
    <h2>Islamic Quiz Earning Platform</h2>    
    <div id="successMessage" class="success-message"></div>    
    <form id="registerForm">    
      <label for="username">Username (1-10 Characters)</label>    
      <input type="text" id="username" minlength="1" maxlength="10" required placeholder="Enter username (1-10 characters)">    
      <div id="usernameError" class="error-message"></div>  
      
      <label for="whatsapp">WhatsApp Number (11 Digits)</label>    
      <input type="text" id="whatsapp" required placeholder="03XXXXXXXXX" inputmode="numeric" maxlength="11">    
      <div id="whatsappError" class="error-message"></div>    
      
      <label for="plan">Select Investment Plan</label>    
      <select id="plan" required>    
        <option value="">Select Plan</option>    
        <option value="1000">Plan 1000 → Daily 600 | Referral: 300/member</option>    
        <option value="1500">Plan 1500 → Daily 900 | Referral: 600/member</option>    
        <option value="2000">Plan 2000 → Daily 1200 | Referral: 900/member</option>    
      </select>    
      
      <label for="payment">Payment Method</label>    
      <select id="payment" required>    
        <option value="">Select Payment Method</option>    
        <option value="easypaisa">Easypaisa</option>    
        <option value="jazzcash">JazzCash</option>    
      </select>    
      
      <div id="paymentDetails" class="payment-details">    
        <label for="accountNumber">Account Number (11 Digits)</label>    
        <input type="text" id="accountNumber" placeholder="Enter 11 digit account number" inputmode="numeric" maxlength="11">    
        <div id="accountNumberError" class="error-message"></div>
            
        <label for="accountName">Account Holder Name</label>    
        <input type="text" id="accountName" placeholder="e.g. Nudba">    
            
        <label for="screenshot">Upload Payment Screenshot</label>    
        <input type="file" id="screenshot" accept="image/*">    
      </div>    
      
      <button type="button" id="continueBtn">Continue to Next Step</button>    
      <div id="loading" class="loading">⏳ Please wait... Submitting your registration.</div>
    </form>    
    <div class="login-link">    
      Already have an account? <a href="index.html">Login Here</a>    
    </div>  
    <div class="islamic-verse">  
      ﴿ وَقُلْ رَبِّ زِدْنِي عِلْمًا ﴾<br>  
      اور دعا کرو: اے میرے رب! میرے علم میں اضافہ فرما۔<br>  
      (سورۃ طٰہٰ - آیت 114)  
    </div>
  </div>    

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Real-time validation for username (1-10 characters)  
      document.getElementById('username').addEventListener('input', function(e) {  
        if (this.value.length > 10) {  
          this.value = this.value.slice(0, 10);  
          document.getElementById('usernameError').textContent = 'Username must be 1-10 characters';  
          document.getElementById('usernameError').style.display = 'block';  
        } else {  
          document.getElementById('usernameError').style.display = 'none';  
        }  
      });  
  
      // Real-time validation for WhatsApp (exactly 11 digits)
      document.getElementById('whatsapp').addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value.length > 11) {
          this.value = this.value.slice(0, 11);
        }
        if (this.value.length > 0 && this.value.length !== 11) {
          document.getElementById('whatsappError').textContent = 'Must be exactly 11 digits';
          document.getElementById('whatsappError').style.display = 'block';
        } else {
          document.getElementById('whatsappError').style.display = 'none';
        }
      });

      // Real-time validation for account number (exactly 11 digits)
      document.getElementById('accountNumber').addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value.length > 11) {
          this.value = this.value.slice(0, 11);
        }
        if (this.value.length > 0 && this.value.length !== 11) {
          document.getElementById('accountNumberError').textContent = 'Must be exactly 11 digits';
          document.getElementById('accountNumberError').style.display = 'block';
        } else {
          document.getElementById('accountNumberError').style.display = 'none';
        }
      });
  
      // Show payment details when payment method is selected    
      document.getElementById("payment").addEventListener("change", function() {    
        const paymentDetails = document.getElementById("paymentDetails");    
        if (this.value === "easypaisa" || this.value === "jazzcash") {    
          paymentDetails.style.display = "block";    
          document.getElementById("screenshot").required = true;    
          document.getElementById("accountNumber").required = true;    
          document.getElementById("accountName").required = true;    
        } else {    
          paymentDetails.style.display = "none";    
          document.getElementById("screenshot").required = false;    
          document.getElementById("accountNumber").required = false;    
          document.getElementById("accountName").required = false;    
        }    
      });    
  
      document.getElementById("continueBtn").addEventListener("click", function() {    
        // Reset error messages    
        document.querySelectorAll('.error-message').forEach(el => {    
          el.style.display = 'none';    
          el.textContent = '';    
        });    
            
        // Get form values    
        const username = document.getElementById("username").value.trim();    
        const whatsapp = document.getElementById("whatsapp").value.trim();    
        const plan = document.getElementById("plan").value;    
        const payment = document.getElementById("payment").value;    
        const accountNumber = document.getElementById("accountNumber")?.value.trim();    
        const accountName = document.getElementById("accountName")?.value.trim();    
        const screenshot = document.getElementById("screenshot")?.files[0];    
            
        // Validate username (1-10 characters)  
        if (username.length < 1 || username.length > 10) {  
          document.getElementById("usernameError").textContent = "Username must be 1-10 characters";  
          document.getElementById("usernameError").style.display = "block";  
          return;  
        }  
  
        // Validate WhatsApp number (11 digits)  
        if (!/^\d{11}$/.test(whatsapp)) {  
          document.getElementById("whatsappError").textContent = "Must be exactly 11 digits";  
          document.getElementById("whatsappError").style.display = "block";  
          return;  
        }  
            
        // Validate plan selection  
        if (!plan) {  
          alert("Please select an investment plan");  
          return;  
        }  
            
        // Validate payment method  
        if (!payment) {  
          alert("Please select a payment method");  
          return;  
        }  
            
        // If payment method requires details, validate them  
        if ((payment === "easypaisa" || payment === "jazzcash")) {  
          if (!accountNumber || !/^\d{11}$/.test(accountNumber)) {
            document.getElementById("accountNumberError").textContent = "Must be exactly 11 digits";  
            document.getElementById("accountNumberError").style.display = "block";  
            return;
          }
          if (!accountName) {  
            alert("Please enter account holder name");  
            return;  
          }  
          if (!screenshot) {  
            alert("Please upload payment screenshot");  
            return;  
          }  
        }  
            
        // Show loading message
        document.getElementById('loading').style.display = 'block';
        document.getElementById('continueBtn').style.display = 'none';
            
        // Store form data in localStorage to pass to next page
        const formData = {
          username,
          whatsapp,
          plan,
          payment,
          accountNumber: accountNumber || "",
          accountName: accountName || "",
          hasScreenshot: !!screenshot
        };
        
        localStorage.setItem('registrationData', JSON.stringify(formData));
        
        // If screenshot exists, convert to base64 and store
        if (screenshot) {
          const reader = new FileReader();
          reader.onload = function(e) {
            localStorage.setItem('paymentScreenshot', e.target.result);
            window.location.href = "page.html";
          };
          reader.readAsDataURL(screenshot);
        } else {
          window.location.href = "page.html";
        }
      });    
    });
  </script>
</body>    
</html>
